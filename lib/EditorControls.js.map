{"version":3,"sources":["../src/EditorControls.js"],"names":["EditorControls","props","context","localize","dictionaries","locale","key","plotly","plotSchema","PlotSchema","get","nextProps","updatePayload","length","handleDataSourceChange","gd","graphDiv","advancedTraceTypeSelector","config","_context","srcConverters","data","dataSources","dataSourceOptions","dataSourceValueRenderer","dataSourceOptionRenderer","frames","_transitionData","_frames","fullData","_fullData","fullLayout","_fullLayout","layout","onUpdate","handleUpdate","bind","traceTypesConfig","showFieldTooltips","glByDefault","mapBoxAccess","fontOptions","chartHelp","forEach","type","EDITOR_ACTIONS","UPDATE_TRACES","payload","beforeUpdateTraces","i","traceIndexes","attr","traceIndex","splitTraceGroup","toString","value","update","p","set","afterUpdateTraces","slice","UPDATE_LAYOUT","beforeUpdateLayout","prop","afterUpdateLayout","Object","assign","ADD_TRACE","beforeAddTrace","push","makeDefaultTrace","mode","prevTrace","prevTraceType","endsWith","afterAddTrace","DELETE_TRACE","beforeDeleteTrace","splice","afterDeleteTrace","DELETE_ANNOTATION","annotationIndex","beforeDeleteAnnotation","annotations","afterDeleteAnnotation","DELETE_SHAPE","shapeIndex","beforeDeleteShape","shapes","afterDeleteShape","DELETE_IMAGE","imageIndex","beforeDeleteImage","images","afterDeleteImage","DELETE_RANGESELECTOR","rangeselectorIndex","axisId","rangeselector","buttons","DELETE_TRANSFORM","transformIndex","transforms","Error","provideValue","className","children","optionalPanel","menuPanelOrder","Component","propTypes","PropTypes","bool","func","node","string","shape","toSrc","isRequired","fromSrc","array","object","defaultProps","categories","_","traces","complex","DEFAULT_FONTS","childContextTypes","any"],"mappings":"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","file":"EditorControls.js","sourcesContent":["import DefaultEditor from './DefaultEditor';\nimport PropTypes from 'prop-types';\nimport React, {Component} from 'react';\nimport {bem, localizeString, plotlyTraceToCustomTrace, traceTypeToPlotlyInitFigure} from './lib';\nimport {\n  shamefullyClearAxisTypes,\n  shamefullyAdjustAxisRef,\n  shamefullyAdjustGeo,\n  shamefullyAddTableColumns,\n  shamefullyCreateSplitStyleProps,\n  shamefullyAdjustSplitStyleTargetContainers,\n  shamefullyDeleteRelatedAnalysisTransforms,\n  shamefullyAdjustSizeref,\n} from './shame';\nimport {EDITOR_ACTIONS} from './lib/constants';\nimport isNumeric from 'fast-isnumeric';\nimport nestedProperty from 'plotly.js/src/lib/nested_property';\nimport {categoryLayout, traceTypes} from 'lib/traceTypes';\nimport {ModalProvider} from 'components/containers';\nimport {DEFAULT_FONTS} from 'lib/constants';\nimport {EditorControlsContext} from './context';\n\nclass EditorControls extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.localize = key => localizeString(this.props.dictionaries || {}, this.props.locale, key);\n\n    // we only need to compute this once.\n    if (this.props.plotly) {\n      this.plotSchema = this.props.plotly.PlotSchema.get();\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    const {updatePayload} = nextProps;\n    if (updatePayload && updatePayload.length > 0) {\n      this.handleDataSourceChange(updatePayload);\n    }\n  }\n\n  getChildContext() {\n    const gd = this.props.graphDiv || {};\n    return {\n      advancedTraceTypeSelector: this.props.advancedTraceTypeSelector,\n      config: gd._context,\n      srcConverters: this.props.srcConverters,\n      data: gd.data,\n      dataSources: this.props.dataSources,\n      dataSourceOptions: this.props.dataSourceOptions,\n      dataSourceValueRenderer: this.props.dataSourceValueRenderer,\n      dataSourceOptionRenderer: this.props.dataSourceOptionRenderer,\n      dictionaries: this.props.dictionaries || {},\n      localize: this.localize,\n      frames: gd._transitionData ? gd._transitionData._frames : [],\n      fullData: gd._fullData,\n      fullLayout: gd._fullLayout,\n      graphDiv: gd,\n      layout: gd.layout,\n      locale: this.props.locale,\n      onUpdate: this.handleUpdate.bind(this),\n      plotSchema: this.plotSchema,\n      plotly: this.props.plotly,\n      traceTypesConfig: this.props.traceTypesConfig,\n      showFieldTooltips: this.props.showFieldTooltips,\n      glByDefault: this.props.glByDefault,\n      mapBoxAccess: this.props.mapBoxAccess,\n      fontOptions: this.props.fontOptions,\n      chartHelp: this.props.chartHelp,\n    };\n  }\n\n  provideValue() {\n    const gd = this.props.graphDiv || {};\n    return {\n      advancedTraceTypeSelector: this.props.advancedTraceTypeSelector,\n      config: gd._context,\n      srcConverters: this.props.srcConverters,\n      data: gd.data,\n      dataSources: this.props.dataSources,\n      dataSourceOptions: this.props.dataSourceOptions,\n      dataSourceValueRenderer: this.props.dataSourceValueRenderer,\n      dataSourceOptionRenderer: this.props.dataSourceOptionRenderer,\n      dictionaries: this.props.dictionaries || {},\n      localize: this.localize,\n      frames: gd._transitionData ? gd._transitionData._frames : [],\n      fullData: gd._fullData,\n      fullLayout: gd._fullLayout,\n      graphDiv: gd,\n      layout: gd.layout,\n      locale: this.props.locale,\n      onUpdate: this.handleUpdate.bind(this),\n      plotSchema: this.plotSchema,\n      plotly: this.props.plotly,\n      traceTypesConfig: this.props.traceTypesConfig,\n      showFieldTooltips: this.props.showFieldTooltips,\n      glByDefault: this.props.glByDefault,\n      mapBoxAccess: this.props.mapBoxAccess,\n      fontOptions: this.props.fontOptions,\n      chartHelp: this.props.chartHelp,\n    };\n  }\n\n  handleDataSourceChange(updatePayload) {\n    if (updatePayload && updatePayload.length !== 0) {\n      updatePayload.forEach(payload => {\n        this.handleUpdate({\n          type: EDITOR_ACTIONS.UPDATE_TRACES,\n          payload,\n        });\n      });\n    }\n  }\n\n  handleUpdate({type, payload}) {\n    const {graphDiv} = this.props;\n\n    switch (type) {\n      case EDITOR_ACTIONS.UPDATE_TRACES:\n        if (this.props.beforeUpdateTraces) {\n          this.props.beforeUpdateTraces(payload);\n        }\n\n        shamefullyAdjustSizeref(graphDiv, payload);\n        shamefullyClearAxisTypes(graphDiv, payload);\n        shamefullyAdjustAxisRef(graphDiv, payload);\n        shamefullyAddTableColumns(graphDiv, payload);\n        shamefullyAdjustSplitStyleTargetContainers(graphDiv, payload);\n\n        for (let i = 0; i < payload.traceIndexes.length; i++) {\n          for (const attr in payload.update) {\n            const traceIndex = payload.traceIndexes[i];\n            const splitTraceGroup = payload.splitTraceGroup\n              ? payload.splitTraceGroup.toString()\n              : null;\n\n            let props = [nestedProperty(graphDiv.data[traceIndex], attr)];\n            const value = payload.update[attr];\n\n            if (splitTraceGroup) {\n              props = shamefullyCreateSplitStyleProps(graphDiv, attr, traceIndex, splitTraceGroup);\n            }\n\n            props.forEach(p => {\n              if (value !== void 0) {\n                p.set(value);\n              }\n            });\n          }\n        }\n\n        if (this.props.afterUpdateTraces) {\n          this.props.afterUpdateTraces(payload);\n        }\n        if (this.props.onUpdate) {\n          this.props.onUpdate(\n            graphDiv.data.slice(),\n            graphDiv.layout,\n            graphDiv._transitionData._frames\n          );\n        }\n        break;\n\n      case EDITOR_ACTIONS.UPDATE_LAYOUT:\n        shamefullyAdjustGeo(graphDiv, payload);\n\n        if (this.props.beforeUpdateLayout) {\n          this.props.beforeUpdateLayout(payload);\n        }\n        for (const attr in payload.update) {\n          const prop = nestedProperty(graphDiv.layout, attr);\n          const value = payload.update[attr];\n          if (value !== void 0) {\n            prop.set(value);\n          }\n        }\n        if (this.props.afterUpdateLayout) {\n          this.props.afterUpdateLayout(payload);\n        }\n        if (this.props.onUpdate) {\n          this.props.onUpdate(\n            graphDiv.data,\n            Object.assign({}, graphDiv.layout),\n            graphDiv._transitionData._frames\n          );\n        }\n        break;\n\n      case EDITOR_ACTIONS.ADD_TRACE:\n        if (this.props.beforeAddTrace) {\n          this.props.beforeAddTrace(payload);\n        }\n\n        // can't use default prop because plotly.js mutates it:\n        // https://github.com/plotly/react-chart-editor/issues/509\n        if (graphDiv.data.length === 0) {\n          graphDiv.data.push(\n            this.props.makeDefaultTrace\n              ? this.props.makeDefaultTrace()\n              : {\n                  type: `scatter${this.props.glByDefault ? 'gl' : ''}`,\n                  mode: 'markers',\n                }\n          );\n        } else {\n          const prevTrace = graphDiv.data[graphDiv.data.length - 1];\n          const prevTraceType = plotlyTraceToCustomTrace(prevTrace);\n          graphDiv.data.push(\n            traceTypeToPlotlyInitFigure(\n              prevTraceType,\n              prevTrace.type && prevTrace.type.endsWith('gl') ? 'gl' : ''\n            )\n          );\n        }\n\n        if (this.props.afterAddTrace) {\n          this.props.afterAddTrace(payload);\n        }\n        if (this.props.onUpdate) {\n          this.props.onUpdate(\n            graphDiv.data.slice(),\n            graphDiv.layout,\n            graphDiv._transitionData._frames\n          );\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_TRACE:\n        if (payload.traceIndexes && payload.traceIndexes.length) {\n          if (this.props.beforeDeleteTrace) {\n            this.props.beforeDeleteTrace(payload);\n          }\n\n          shamefullyAdjustAxisRef(graphDiv, payload);\n          shamefullyDeleteRelatedAnalysisTransforms(graphDiv, payload);\n\n          graphDiv.data.splice(payload.traceIndexes[0], 1);\n          if (this.props.afterDeleteTrace) {\n            this.props.afterDeleteTrace(payload);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data.slice(),\n              graphDiv.layout,\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_ANNOTATION:\n        if (isNumeric(payload.annotationIndex)) {\n          if (this.props.beforeDeleteAnnotation) {\n            this.props.beforeDeleteAnnotation(payload);\n          }\n          graphDiv.layout.annotations.splice(payload.annotationIndex, 1);\n          if (this.props.afterDeleteAnnotation) {\n            this.props.afterDeleteAnnotation(payload);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data,\n              Object.assign({}, graphDiv.layout),\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_SHAPE:\n        if (isNumeric(payload.shapeIndex)) {\n          if (this.props.beforeDeleteShape) {\n            this.props.beforeDeleteShape(payload);\n          }\n          graphDiv.layout.shapes.splice(payload.shapeIndex, 1);\n          if (this.props.afterDeleteShape) {\n            this.props.afterDeleteShape(payload);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data,\n              Object.assign({}, graphDiv.layout),\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_IMAGE:\n        if (isNumeric(payload.imageIndex)) {\n          if (this.props.beforeDeleteImage) {\n            this.props.beforeDeleteImage(payload);\n          }\n          graphDiv.layout.images.splice(payload.imageIndex, 1);\n          if (this.props.afterDeleteImage) {\n            this.props.afterDeleteImage(payload);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data,\n              Object.assign({}, graphDiv.layout),\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_RANGESELECTOR:\n        if (isNumeric(payload.rangeselectorIndex)) {\n          graphDiv.layout[payload.axisId].rangeselector.buttons.splice(\n            payload.rangeselectorIndex,\n            1\n          );\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data,\n              Object.assign({}, graphDiv.layout),\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_TRANSFORM:\n        if (isNumeric(payload.transformIndex) && payload.traceIndex < graphDiv.data.length) {\n          if (graphDiv.data[payload.traceIndex].transforms.length === 1) {\n            delete graphDiv.data[payload.traceIndex].transforms;\n          } else {\n            graphDiv.data[payload.traceIndex].transforms.splice(payload.transformIndex, 1);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data.slice(),\n              graphDiv.layout,\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      default:\n        throw new Error(this.localize('must specify an action type to handleEditorUpdate'));\n    }\n  }\n\n  render() {\n    return (\n      <EditorControlsContext.Provider value={this.provideValue()}>\n        <div\n          className={\n            bem('editor_controls') +\n            ' plotly-editor--theme-provider' +\n            `${this.props.className ? ` ${this.props.className}` : ''}`\n          }\n        >\n          <ModalProvider>\n            {this.props.graphDiv &&\n              this.props.graphDiv._fullLayout &&\n              (this.props.children ? (\n                this.props.children\n              ) : this.props.optionalPanel ? (\n                <DefaultEditor menuPanelOrder={this.props.menuPanelOrder}>\n                  {this.props.optionalPanel}\n                </DefaultEditor>\n              ) : (\n                <DefaultEditor />\n              ))}\n          </ModalProvider>\n        </div>\n      </EditorControlsContext.Provider>\n    );\n  }\n}\n\nEditorControls.propTypes = {\n  advancedTraceTypeSelector: PropTypes.bool,\n  afterAddTrace: PropTypes.func,\n  afterDeleteAnnotation: PropTypes.func,\n  afterDeleteShape: PropTypes.func,\n  afterDeleteImage: PropTypes.func,\n  afterDeleteTrace: PropTypes.func,\n  afterUpdateLayout: PropTypes.func,\n  afterUpdateTraces: PropTypes.func,\n  beforeAddTrace: PropTypes.func,\n  beforeDeleteAnnotation: PropTypes.func,\n  beforeDeleteShape: PropTypes.func,\n  beforeDeleteImage: PropTypes.func,\n  beforeDeleteTrace: PropTypes.func,\n  beforeUpdateLayout: PropTypes.func,\n  beforeUpdateTraces: PropTypes.func,\n  children: PropTypes.node,\n  className: PropTypes.string,\n  srcConverters: PropTypes.shape({\n    toSrc: PropTypes.func.isRequired,\n    fromSrc: PropTypes.func.isRequired,\n  }),\n  dataSourceOptionRenderer: PropTypes.func,\n  dataSourceOptions: PropTypes.array,\n  dataSources: PropTypes.object,\n  dataSourceValueRenderer: PropTypes.func,\n  dictionaries: PropTypes.object,\n  graphDiv: PropTypes.object,\n  locale: PropTypes.string,\n  onUpdate: PropTypes.func,\n  plotly: PropTypes.object,\n  showFieldTooltips: PropTypes.bool,\n  traceTypesConfig: PropTypes.object,\n  makeDefaultTrace: PropTypes.func,\n  glByDefault: PropTypes.bool,\n  mapBoxAccess: PropTypes.bool,\n  fontOptions: PropTypes.array,\n  chartHelp: PropTypes.object,\n  optionalPanel: PropTypes.node,\n  menuPanelOrder: PropTypes.array,\n  updatePayload: PropTypes.array,\n};\n\nEditorControls.defaultProps = {\n  showFieldTooltips: false,\n  locale: 'en',\n  traceTypesConfig: {\n    categories: _ => categoryLayout(_),\n    traces: _ => traceTypes(_),\n    complex: true,\n  },\n  fontOptions: DEFAULT_FONTS,\n};\n\nEditorControls.childContextTypes = {\n  advancedTraceTypeSelector: PropTypes.bool,\n  config: PropTypes.object,\n  srcConverters: PropTypes.shape({\n    toSrc: PropTypes.func.isRequired,\n    fromSrc: PropTypes.func.isRequired,\n  }),\n  data: PropTypes.array,\n  dataSourceOptionRenderer: PropTypes.func,\n  dataSourceOptions: PropTypes.array,\n  dataSources: PropTypes.object,\n  dataSourceValueRenderer: PropTypes.func,\n  dictionaries: PropTypes.object,\n  frames: PropTypes.array,\n  fullData: PropTypes.array,\n  fullLayout: PropTypes.object,\n  graphDiv: PropTypes.any,\n  layout: PropTypes.object,\n  locale: PropTypes.string,\n  localize: PropTypes.func,\n  onUpdate: PropTypes.func,\n  plotly: PropTypes.object,\n  plotSchema: PropTypes.object,\n  traceTypesConfig: PropTypes.object,\n  showFieldTooltips: PropTypes.bool,\n  glByDefault: PropTypes.bool,\n  mapBoxAccess: PropTypes.bool,\n  fontOptions: PropTypes.array,\n  chartHelp: PropTypes.object,\n};\n\nexport default EditorControls;\n"]}