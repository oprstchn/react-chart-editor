{"version":3,"sources":["../src/EditorControls.js"],"names":["EditorControls","props","context","localize","dictionaries","locale","key","plotly","plotSchema","PlotSchema","get","nextProps","updatePayload","length","handleUpdateActions","gd","graphDiv","advancedTraceTypeSelector","config","_context","srcConverters","data","dataSources","dataSourceOptions","dataSourceValueRenderer","dataSourceOptionRenderer","frames","_transitionData","_frames","fullData","_fullData","fullLayout","_fullLayout","layout","onUpdate","handleUpdate","bind","traceTypesConfig","showFieldTooltips","glByDefault","mapBoxAccess","fontOptions","chartHelp","forEach","actions","type","payload","EDITOR_ACTIONS","UPDATE_TRACES","beforeUpdateTraces","i","traceIndexes","attr","traceIndex","splitTraceGroup","toString","value","update","p","set","afterUpdateTraces","slice","UPDATE_LAYOUT","beforeUpdateLayout","prop","afterUpdateLayout","Object","assign","ADD_TRACE","beforeAddTrace","push","makeDefaultTrace","mode","prevTrace","prevTraceType","endsWith","afterAddTrace","DELETE_TRACE","beforeDeleteTrace","splice","afterDeleteTrace","DELETE_ANNOTATION","annotationIndex","beforeDeleteAnnotation","annotations","afterDeleteAnnotation","DELETE_SHAPE","shapeIndex","beforeDeleteShape","shapes","afterDeleteShape","DELETE_IMAGE","imageIndex","beforeDeleteImage","images","afterDeleteImage","DELETE_RANGESELECTOR","rangeselectorIndex","axisId","rangeselector","buttons","DELETE_TRANSFORM","transformIndex","transforms","Error","provideValue","className","children","optionalPanel","menuPanelOrder","Component","propTypes","PropTypes","bool","func","node","string","shape","toSrc","isRequired","fromSrc","array","object","defaultProps","categories","_","traces","complex","DEFAULT_FONTS","childContextTypes","any"],"mappings":"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","file":"EditorControls.js","sourcesContent":["import DefaultEditor from './DefaultEditor';\nimport PropTypes from 'prop-types';\nimport React, {Component} from 'react';\nimport {bem, localizeString, plotlyTraceToCustomTrace, traceTypeToPlotlyInitFigure} from './lib';\nimport {\n  shamefullyClearAxisTypes,\n  shamefullyAdjustAxisRef,\n  shamefullyAdjustGeo,\n  shamefullyAddTableColumns,\n  shamefullyCreateSplitStyleProps,\n  shamefullyAdjustSplitStyleTargetContainers,\n  shamefullyDeleteRelatedAnalysisTransforms,\n  shamefullyAdjustSizeref,\n} from './shame';\nimport {EDITOR_ACTIONS} from './lib/constants';\nimport isNumeric from 'fast-isnumeric';\nimport nestedProperty from 'plotly.js/src/lib/nested_property';\nimport {categoryLayout, traceTypes} from 'lib/traceTypes';\nimport {ModalProvider} from 'components/containers';\nimport {DEFAULT_FONTS} from 'lib/constants';\nimport {EditorControlsContext} from './context';\n\nclass EditorControls extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.localize = key => localizeString(this.props.dictionaries || {}, this.props.locale, key);\n\n    // we only need to compute this once.\n    if (this.props.plotly) {\n      this.plotSchema = this.props.plotly.PlotSchema.get();\n    }\n  }\n\n  componentWillReceiveProps(nextProps) {\n    const {updatePayload} = nextProps;\n    if (updatePayload && updatePayload.length > 0) {\n      this.handleUpdateActions(updatePayload);\n    }\n  }\n\n  getChildContext() {\n    const gd = this.props.graphDiv || {};\n    return {\n      advancedTraceTypeSelector: this.props.advancedTraceTypeSelector,\n      config: gd._context,\n      srcConverters: this.props.srcConverters,\n      data: gd.data,\n      dataSources: this.props.dataSources,\n      dataSourceOptions: this.props.dataSourceOptions,\n      dataSourceValueRenderer: this.props.dataSourceValueRenderer,\n      dataSourceOptionRenderer: this.props.dataSourceOptionRenderer,\n      dictionaries: this.props.dictionaries || {},\n      localize: this.localize,\n      frames: gd._transitionData ? gd._transitionData._frames : [],\n      fullData: gd._fullData,\n      fullLayout: gd._fullLayout,\n      graphDiv: gd,\n      layout: gd.layout,\n      locale: this.props.locale,\n      onUpdate: this.handleUpdate.bind(this),\n      plotSchema: this.plotSchema,\n      plotly: this.props.plotly,\n      traceTypesConfig: this.props.traceTypesConfig,\n      showFieldTooltips: this.props.showFieldTooltips,\n      glByDefault: this.props.glByDefault,\n      mapBoxAccess: this.props.mapBoxAccess,\n      fontOptions: this.props.fontOptions,\n      chartHelp: this.props.chartHelp,\n    };\n  }\n\n  provideValue() {\n    const gd = this.props.graphDiv || {};\n    return {\n      advancedTraceTypeSelector: this.props.advancedTraceTypeSelector,\n      config: gd._context,\n      srcConverters: this.props.srcConverters,\n      data: gd.data,\n      dataSources: this.props.dataSources,\n      dataSourceOptions: this.props.dataSourceOptions,\n      dataSourceValueRenderer: this.props.dataSourceValueRenderer,\n      dataSourceOptionRenderer: this.props.dataSourceOptionRenderer,\n      dictionaries: this.props.dictionaries || {},\n      localize: this.localize,\n      frames: gd._transitionData ? gd._transitionData._frames : [],\n      fullData: gd._fullData,\n      fullLayout: gd._fullLayout,\n      graphDiv: gd,\n      layout: gd.layout,\n      locale: this.props.locale,\n      onUpdate: this.handleUpdate.bind(this),\n      plotSchema: this.plotSchema,\n      plotly: this.props.plotly,\n      traceTypesConfig: this.props.traceTypesConfig,\n      showFieldTooltips: this.props.showFieldTooltips,\n      glByDefault: this.props.glByDefault,\n      mapBoxAccess: this.props.mapBoxAccess,\n      fontOptions: this.props.fontOptions,\n      chartHelp: this.props.chartHelp,\n    };\n  }\n\n  handleUpdateActions(updatePayload) {\n    if (updatePayload && updatePayload.length !== 0) {\n      updatePayload.forEach(actions => {\n        this.handleUpdate(actions);\n      });\n    }\n  }\n\n  handleUpdate({type, payload}) {\n    const {graphDiv} = this.props;\n\n    switch (type) {\n      case EDITOR_ACTIONS.UPDATE_TRACES:\n        if (this.props.beforeUpdateTraces) {\n          this.props.beforeUpdateTraces(payload);\n        }\n\n        shamefullyAdjustSizeref(graphDiv, payload);\n        shamefullyClearAxisTypes(graphDiv, payload);\n        shamefullyAdjustAxisRef(graphDiv, payload);\n        shamefullyAddTableColumns(graphDiv, payload);\n        shamefullyAdjustSplitStyleTargetContainers(graphDiv, payload);\n\n        for (let i = 0; i < payload.traceIndexes.length; i++) {\n          for (const attr in payload.update) {\n            const traceIndex = payload.traceIndexes[i];\n            const splitTraceGroup = payload.splitTraceGroup\n              ? payload.splitTraceGroup.toString()\n              : null;\n\n            let props = [nestedProperty(graphDiv.data[traceIndex], attr)];\n            const value = payload.update[attr];\n\n            if (splitTraceGroup) {\n              props = shamefullyCreateSplitStyleProps(graphDiv, attr, traceIndex, splitTraceGroup);\n            }\n\n            props.forEach(p => {\n              if (value !== void 0) {\n                p.set(value);\n              }\n            });\n          }\n        }\n\n        if (this.props.afterUpdateTraces) {\n          this.props.afterUpdateTraces(payload);\n        }\n        if (this.props.onUpdate) {\n          this.props.onUpdate(\n            graphDiv.data.slice(),\n            graphDiv.layout,\n            graphDiv._transitionData._frames\n          );\n        }\n        break;\n\n      case EDITOR_ACTIONS.UPDATE_LAYOUT:\n        shamefullyAdjustGeo(graphDiv, payload);\n\n        if (this.props.beforeUpdateLayout) {\n          this.props.beforeUpdateLayout(payload);\n        }\n        for (const attr in payload.update) {\n          const prop = nestedProperty(graphDiv.layout, attr);\n          const value = payload.update[attr];\n          if (value !== void 0) {\n            prop.set(value);\n          }\n        }\n        if (this.props.afterUpdateLayout) {\n          this.props.afterUpdateLayout(payload);\n        }\n        if (this.props.onUpdate) {\n          this.props.onUpdate(\n            graphDiv.data,\n            Object.assign({}, graphDiv.layout),\n            graphDiv._transitionData._frames\n          );\n        }\n        break;\n\n      case EDITOR_ACTIONS.ADD_TRACE:\n        if (this.props.beforeAddTrace) {\n          this.props.beforeAddTrace(payload);\n        }\n\n        // can't use default prop because plotly.js mutates it:\n        // https://github.com/plotly/react-chart-editor/issues/509\n        if (graphDiv.data.length === 0) {\n          graphDiv.data.push(\n            this.props.makeDefaultTrace\n              ? this.props.makeDefaultTrace()\n              : {\n                  type: `scatter${this.props.glByDefault ? 'gl' : ''}`,\n                  mode: 'markers',\n                }\n          );\n        } else {\n          const prevTrace = graphDiv.data[graphDiv.data.length - 1];\n          const prevTraceType = plotlyTraceToCustomTrace(prevTrace);\n          graphDiv.data.push(\n            traceTypeToPlotlyInitFigure(\n              prevTraceType,\n              prevTrace.type && prevTrace.type.endsWith('gl') ? 'gl' : ''\n            )\n          );\n        }\n\n        if (this.props.afterAddTrace) {\n          this.props.afterAddTrace(payload);\n        }\n        if (this.props.onUpdate) {\n          this.props.onUpdate(\n            graphDiv.data.slice(),\n            graphDiv.layout,\n            graphDiv._transitionData._frames\n          );\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_TRACE:\n        if (payload.traceIndexes && payload.traceIndexes.length) {\n          if (this.props.beforeDeleteTrace) {\n            this.props.beforeDeleteTrace(payload);\n          }\n\n          shamefullyAdjustAxisRef(graphDiv, payload);\n          shamefullyDeleteRelatedAnalysisTransforms(graphDiv, payload);\n\n          graphDiv.data.splice(payload.traceIndexes[0], 1);\n          if (this.props.afterDeleteTrace) {\n            this.props.afterDeleteTrace(payload);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data.slice(),\n              graphDiv.layout,\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_ANNOTATION:\n        if (isNumeric(payload.annotationIndex)) {\n          if (this.props.beforeDeleteAnnotation) {\n            this.props.beforeDeleteAnnotation(payload);\n          }\n          graphDiv.layout.annotations.splice(payload.annotationIndex, 1);\n          if (this.props.afterDeleteAnnotation) {\n            this.props.afterDeleteAnnotation(payload);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data,\n              Object.assign({}, graphDiv.layout),\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_SHAPE:\n        if (isNumeric(payload.shapeIndex)) {\n          if (this.props.beforeDeleteShape) {\n            this.props.beforeDeleteShape(payload);\n          }\n          graphDiv.layout.shapes.splice(payload.shapeIndex, 1);\n          if (this.props.afterDeleteShape) {\n            this.props.afterDeleteShape(payload);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data,\n              Object.assign({}, graphDiv.layout),\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_IMAGE:\n        if (isNumeric(payload.imageIndex)) {\n          if (this.props.beforeDeleteImage) {\n            this.props.beforeDeleteImage(payload);\n          }\n          graphDiv.layout.images.splice(payload.imageIndex, 1);\n          if (this.props.afterDeleteImage) {\n            this.props.afterDeleteImage(payload);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data,\n              Object.assign({}, graphDiv.layout),\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_RANGESELECTOR:\n        if (isNumeric(payload.rangeselectorIndex)) {\n          graphDiv.layout[payload.axisId].rangeselector.buttons.splice(\n            payload.rangeselectorIndex,\n            1\n          );\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data,\n              Object.assign({}, graphDiv.layout),\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_TRANSFORM:\n        if (isNumeric(payload.transformIndex) && payload.traceIndex < graphDiv.data.length) {\n          if (graphDiv.data[payload.traceIndex].transforms.length === 1) {\n            delete graphDiv.data[payload.traceIndex].transforms;\n          } else {\n            graphDiv.data[payload.traceIndex].transforms.splice(payload.transformIndex, 1);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data.slice(),\n              graphDiv.layout,\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      default:\n        throw new Error(this.localize('must specify an action type to handleEditorUpdate'));\n    }\n  }\n\n  render() {\n    return (\n      <EditorControlsContext.Provider value={this.provideValue()}>\n        <div\n          className={\n            bem('editor_controls') +\n            ' plotly-editor--theme-provider' +\n            `${this.props.className ? ` ${this.props.className}` : ''}`\n          }\n        >\n          <ModalProvider>\n            {this.props.graphDiv &&\n              this.props.graphDiv._fullLayout &&\n              (this.props.children ? (\n                this.props.children\n              ) : this.props.optionalPanel ? (\n                <DefaultEditor menuPanelOrder={this.props.menuPanelOrder}>\n                  {this.props.optionalPanel}\n                </DefaultEditor>\n              ) : (\n                <DefaultEditor />\n              ))}\n          </ModalProvider>\n        </div>\n      </EditorControlsContext.Provider>\n    );\n  }\n}\n\nEditorControls.propTypes = {\n  advancedTraceTypeSelector: PropTypes.bool,\n  afterAddTrace: PropTypes.func,\n  afterDeleteAnnotation: PropTypes.func,\n  afterDeleteShape: PropTypes.func,\n  afterDeleteImage: PropTypes.func,\n  afterDeleteTrace: PropTypes.func,\n  afterUpdateLayout: PropTypes.func,\n  afterUpdateTraces: PropTypes.func,\n  beforeAddTrace: PropTypes.func,\n  beforeDeleteAnnotation: PropTypes.func,\n  beforeDeleteShape: PropTypes.func,\n  beforeDeleteImage: PropTypes.func,\n  beforeDeleteTrace: PropTypes.func,\n  beforeUpdateLayout: PropTypes.func,\n  beforeUpdateTraces: PropTypes.func,\n  children: PropTypes.node,\n  className: PropTypes.string,\n  srcConverters: PropTypes.shape({\n    toSrc: PropTypes.func.isRequired,\n    fromSrc: PropTypes.func.isRequired,\n  }),\n  dataSourceOptionRenderer: PropTypes.func,\n  dataSourceOptions: PropTypes.array,\n  dataSources: PropTypes.object,\n  dataSourceValueRenderer: PropTypes.func,\n  dictionaries: PropTypes.object,\n  graphDiv: PropTypes.object,\n  locale: PropTypes.string,\n  onUpdate: PropTypes.func,\n  plotly: PropTypes.object,\n  showFieldTooltips: PropTypes.bool,\n  traceTypesConfig: PropTypes.object,\n  makeDefaultTrace: PropTypes.func,\n  glByDefault: PropTypes.bool,\n  mapBoxAccess: PropTypes.bool,\n  fontOptions: PropTypes.array,\n  chartHelp: PropTypes.object,\n  optionalPanel: PropTypes.node,\n  menuPanelOrder: PropTypes.array,\n  updatePayload: PropTypes.array,\n};\n\nEditorControls.defaultProps = {\n  showFieldTooltips: false,\n  locale: 'en',\n  traceTypesConfig: {\n    categories: _ => categoryLayout(_),\n    traces: _ => traceTypes(_),\n    complex: true,\n  },\n  fontOptions: DEFAULT_FONTS,\n};\n\nEditorControls.childContextTypes = {\n  advancedTraceTypeSelector: PropTypes.bool,\n  config: PropTypes.object,\n  srcConverters: PropTypes.shape({\n    toSrc: PropTypes.func.isRequired,\n    fromSrc: PropTypes.func.isRequired,\n  }),\n  data: PropTypes.array,\n  dataSourceOptionRenderer: PropTypes.func,\n  dataSourceOptions: PropTypes.array,\n  dataSources: PropTypes.object,\n  dataSourceValueRenderer: PropTypes.func,\n  dictionaries: PropTypes.object,\n  frames: PropTypes.array,\n  fullData: PropTypes.array,\n  fullLayout: PropTypes.object,\n  graphDiv: PropTypes.any,\n  layout: PropTypes.object,\n  locale: PropTypes.string,\n  localize: PropTypes.func,\n  onUpdate: PropTypes.func,\n  plotly: PropTypes.object,\n  plotSchema: PropTypes.object,\n  traceTypesConfig: PropTypes.object,\n  showFieldTooltips: PropTypes.bool,\n  glByDefault: PropTypes.bool,\n  mapBoxAccess: PropTypes.bool,\n  fontOptions: PropTypes.array,\n  chartHelp: PropTypes.object,\n};\n\nexport default EditorControls;\n"]}