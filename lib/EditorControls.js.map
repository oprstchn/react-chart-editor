{"version":3,"sources":["../src/EditorControls.js"],"names":["EditorControls","props","context","localize","dictionaries","locale","key","plotly","plotSchema","PlotSchema","get","gd","graphDiv","advancedTraceTypeSelector","config","_context","srcConverters","data","dataSources","dataSourceOptions","dataSourceValueRenderer","dataSourceOptionRenderer","frames","_transitionData","_frames","fullData","_fullData","fullLayout","_fullLayout","layout","onUpdate","handleUpdate","bind","traceTypesConfig","showFieldTooltips","glByDefault","mapBoxAccess","fontOptions","chartHelp","type","payload","EDITOR_ACTIONS","UPDATE_TRACES","beforeUpdateTraces","i","traceIndexes","length","attr","traceIndex","splitTraceGroup","toString","value","update","forEach","p","set","afterUpdateTraces","slice","UPDATE_LAYOUT","beforeUpdateLayout","prop","afterUpdateLayout","Object","assign","ADD_TRACE","beforeAddTrace","push","makeDefaultTrace","mode","prevTrace","prevTraceType","endsWith","afterAddTrace","DELETE_TRACE","beforeDeleteTrace","splice","afterDeleteTrace","DELETE_ANNOTATION","annotationIndex","beforeDeleteAnnotation","annotations","afterDeleteAnnotation","DELETE_SHAPE","shapeIndex","beforeDeleteShape","shapes","afterDeleteShape","DELETE_IMAGE","imageIndex","beforeDeleteImage","images","afterDeleteImage","DELETE_RANGESELECTOR","rangeselectorIndex","axisId","rangeselector","buttons","DELETE_TRANSFORM","transformIndex","transforms","Error","provideValue","className","children","Component","propTypes","PropTypes","bool","func","node","string","shape","toSrc","isRequired","fromSrc","array","object","defaultProps","categories","_","traces","complex","DEFAULT_FONTS","childContextTypes","any"],"mappings":"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","file":"EditorControls.js","sourcesContent":["import DefaultEditor from './DefaultEditor';\nimport PropTypes from 'prop-types';\nimport React, {Component} from 'react';\nimport {bem, localizeString, plotlyTraceToCustomTrace, traceTypeToPlotlyInitFigure} from './lib';\nimport {\n  shamefullyClearAxisTypes,\n  shamefullyAdjustAxisRef,\n  shamefullyAdjustGeo,\n  shamefullyAddTableColumns,\n  shamefullyCreateSplitStyleProps,\n  shamefullyAdjustSplitStyleTargetContainers,\n  shamefullyDeleteRelatedAnalysisTransforms,\n  shamefullyAdjustSizeref,\n} from './shame';\nimport {EDITOR_ACTIONS} from './lib/constants';\nimport isNumeric from 'fast-isnumeric';\nimport nestedProperty from 'plotly.js/src/lib/nested_property';\nimport {categoryLayout, traceTypes} from 'lib/traceTypes';\nimport {ModalProvider} from 'components/containers';\nimport {DEFAULT_FONTS} from 'lib/constants';\nimport {EditorControlsContext} from './context';\n\nclass EditorControls extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.localize = key => localizeString(this.props.dictionaries || {}, this.props.locale, key);\n\n    // we only need to compute this once.\n    if (this.props.plotly) {\n      this.plotSchema = this.props.plotly.PlotSchema.get();\n    }\n  }\n\n  getChildContext() {\n    const gd = this.props.graphDiv || {};\n    return {\n      advancedTraceTypeSelector: this.props.advancedTraceTypeSelector,\n      config: gd._context,\n      srcConverters: this.props.srcConverters,\n      data: gd.data,\n      dataSources: this.props.dataSources,\n      dataSourceOptions: this.props.dataSourceOptions,\n      dataSourceValueRenderer: this.props.dataSourceValueRenderer,\n      dataSourceOptionRenderer: this.props.dataSourceOptionRenderer,\n      dictionaries: this.props.dictionaries || {},\n      localize: this.localize,\n      frames: gd._transitionData ? gd._transitionData._frames : [],\n      fullData: gd._fullData,\n      fullLayout: gd._fullLayout,\n      graphDiv: gd,\n      layout: gd.layout,\n      locale: this.props.locale,\n      onUpdate: this.handleUpdate.bind(this),\n      plotSchema: this.plotSchema,\n      plotly: this.props.plotly,\n      traceTypesConfig: this.props.traceTypesConfig,\n      showFieldTooltips: this.props.showFieldTooltips,\n      glByDefault: this.props.glByDefault,\n      mapBoxAccess: this.props.mapBoxAccess,\n      fontOptions: this.props.fontOptions,\n      chartHelp: this.props.chartHelp,\n    };\n  }\n\n  provideValue() {\n    const gd = this.props.graphDiv || {};\n    return {\n      advancedTraceTypeSelector: this.props.advancedTraceTypeSelector,\n      config: gd._context,\n      srcConverters: this.props.srcConverters,\n      data: gd.data,\n      dataSources: this.props.dataSources,\n      dataSourceOptions: this.props.dataSourceOptions,\n      dataSourceValueRenderer: this.props.dataSourceValueRenderer,\n      dataSourceOptionRenderer: this.props.dataSourceOptionRenderer,\n      dictionaries: this.props.dictionaries || {},\n      localize: this.localize,\n      frames: gd._transitionData ? gd._transitionData._frames : [],\n      fullData: gd._fullData,\n      fullLayout: gd._fullLayout,\n      graphDiv: gd,\n      layout: gd.layout,\n      locale: this.props.locale,\n      onUpdate: this.handleUpdate.bind(this),\n      plotSchema: this.plotSchema,\n      plotly: this.props.plotly,\n      traceTypesConfig: this.props.traceTypesConfig,\n      showFieldTooltips: this.props.showFieldTooltips,\n      glByDefault: this.props.glByDefault,\n      mapBoxAccess: this.props.mapBoxAccess,\n      fontOptions: this.props.fontOptions,\n      chartHelp: this.props.chartHelp,\n    };\n  }\n\n  handleUpdate({type, payload}) {\n    const {graphDiv} = this.props;\n\n    switch (type) {\n      case EDITOR_ACTIONS.UPDATE_TRACES:\n        if (this.props.beforeUpdateTraces) {\n          this.props.beforeUpdateTraces(payload);\n        }\n\n        shamefullyAdjustSizeref(graphDiv, payload);\n        shamefullyClearAxisTypes(graphDiv, payload);\n        shamefullyAdjustAxisRef(graphDiv, payload);\n        shamefullyAddTableColumns(graphDiv, payload);\n        shamefullyAdjustSplitStyleTargetContainers(graphDiv, payload);\n\n        for (let i = 0; i < payload.traceIndexes.length; i++) {\n          for (const attr in payload.update) {\n            const traceIndex = payload.traceIndexes[i];\n            const splitTraceGroup = payload.splitTraceGroup\n              ? payload.splitTraceGroup.toString()\n              : null;\n\n            let props = [nestedProperty(graphDiv.data[traceIndex], attr)];\n            const value = payload.update[attr];\n\n            if (splitTraceGroup) {\n              props = shamefullyCreateSplitStyleProps(graphDiv, attr, traceIndex, splitTraceGroup);\n            }\n\n            props.forEach(p => {\n              if (value !== void 0) {\n                p.set(value);\n              }\n            });\n          }\n        }\n\n        if (this.props.afterUpdateTraces) {\n          this.props.afterUpdateTraces(payload);\n        }\n        if (this.props.onUpdate) {\n          this.props.onUpdate(\n            graphDiv.data.slice(),\n            graphDiv.layout,\n            graphDiv._transitionData._frames\n          );\n        }\n        break;\n\n      case EDITOR_ACTIONS.UPDATE_LAYOUT:\n        shamefullyAdjustGeo(graphDiv, payload);\n\n        if (this.props.beforeUpdateLayout) {\n          this.props.beforeUpdateLayout(payload);\n        }\n        for (const attr in payload.update) {\n          const prop = nestedProperty(graphDiv.layout, attr);\n          const value = payload.update[attr];\n          if (value !== void 0) {\n            prop.set(value);\n          }\n        }\n        if (this.props.afterUpdateLayout) {\n          this.props.afterUpdateLayout(payload);\n        }\n        if (this.props.onUpdate) {\n          this.props.onUpdate(\n            graphDiv.data,\n            Object.assign({}, graphDiv.layout),\n            graphDiv._transitionData._frames\n          );\n        }\n        break;\n\n      case EDITOR_ACTIONS.ADD_TRACE:\n        if (this.props.beforeAddTrace) {\n          this.props.beforeAddTrace(payload);\n        }\n\n        // can't use default prop because plotly.js mutates it:\n        // https://github.com/plotly/react-chart-editor/issues/509\n        if (graphDiv.data.length === 0) {\n          graphDiv.data.push(\n            this.props.makeDefaultTrace\n              ? this.props.makeDefaultTrace()\n              : {\n                  type: `scatter${this.props.glByDefault ? 'gl' : ''}`,\n                  mode: 'markers',\n                }\n          );\n        } else {\n          const prevTrace = graphDiv.data[graphDiv.data.length - 1];\n          const prevTraceType = plotlyTraceToCustomTrace(prevTrace);\n          graphDiv.data.push(\n            traceTypeToPlotlyInitFigure(\n              prevTraceType,\n              prevTrace.type && prevTrace.type.endsWith('gl') ? 'gl' : ''\n            )\n          );\n        }\n\n        if (this.props.afterAddTrace) {\n          this.props.afterAddTrace(payload);\n        }\n        if (this.props.onUpdate) {\n          this.props.onUpdate(\n            graphDiv.data.slice(),\n            graphDiv.layout,\n            graphDiv._transitionData._frames\n          );\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_TRACE:\n        if (payload.traceIndexes && payload.traceIndexes.length) {\n          if (this.props.beforeDeleteTrace) {\n            this.props.beforeDeleteTrace(payload);\n          }\n\n          shamefullyAdjustAxisRef(graphDiv, payload);\n          shamefullyDeleteRelatedAnalysisTransforms(graphDiv, payload);\n\n          graphDiv.data.splice(payload.traceIndexes[0], 1);\n          if (this.props.afterDeleteTrace) {\n            this.props.afterDeleteTrace(payload);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data.slice(),\n              graphDiv.layout,\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_ANNOTATION:\n        if (isNumeric(payload.annotationIndex)) {\n          if (this.props.beforeDeleteAnnotation) {\n            this.props.beforeDeleteAnnotation(payload);\n          }\n          graphDiv.layout.annotations.splice(payload.annotationIndex, 1);\n          if (this.props.afterDeleteAnnotation) {\n            this.props.afterDeleteAnnotation(payload);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data,\n              Object.assign({}, graphDiv.layout),\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_SHAPE:\n        if (isNumeric(payload.shapeIndex)) {\n          if (this.props.beforeDeleteShape) {\n            this.props.beforeDeleteShape(payload);\n          }\n          graphDiv.layout.shapes.splice(payload.shapeIndex, 1);\n          if (this.props.afterDeleteShape) {\n            this.props.afterDeleteShape(payload);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data,\n              Object.assign({}, graphDiv.layout),\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_IMAGE:\n        if (isNumeric(payload.imageIndex)) {\n          if (this.props.beforeDeleteImage) {\n            this.props.beforeDeleteImage(payload);\n          }\n          graphDiv.layout.images.splice(payload.imageIndex, 1);\n          if (this.props.afterDeleteImage) {\n            this.props.afterDeleteImage(payload);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data,\n              Object.assign({}, graphDiv.layout),\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_RANGESELECTOR:\n        if (isNumeric(payload.rangeselectorIndex)) {\n          graphDiv.layout[payload.axisId].rangeselector.buttons.splice(\n            payload.rangeselectorIndex,\n            1\n          );\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data,\n              Object.assign({}, graphDiv.layout),\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      case EDITOR_ACTIONS.DELETE_TRANSFORM:\n        if (isNumeric(payload.transformIndex) && payload.traceIndex < graphDiv.data.length) {\n          if (graphDiv.data[payload.traceIndex].transforms.length === 1) {\n            delete graphDiv.data[payload.traceIndex].transforms;\n          } else {\n            graphDiv.data[payload.traceIndex].transforms.splice(payload.transformIndex, 1);\n          }\n          if (this.props.onUpdate) {\n            this.props.onUpdate(\n              graphDiv.data.slice(),\n              graphDiv.layout,\n              graphDiv._transitionData._frames\n            );\n          }\n        }\n        break;\n\n      default:\n        throw new Error(this.localize('must specify an action type to handleEditorUpdate'));\n    }\n  }\n\n  render() {\n    return (\n      <EditorControlsContext.Provider value={this.provideValue()}>\n        <div\n          className={\n            bem('editor_controls') +\n            ' plotly-editor--theme-provider' +\n            `${this.props.className ? ` ${this.props.className}` : ''}`\n          }\n        >\n          <ModalProvider>\n            {this.props.graphDiv &&\n              this.props.graphDiv._fullLayout &&\n              (this.props.children ? this.props.children : <DefaultEditor />)}\n          </ModalProvider>\n        </div>\n      </EditorControlsContext.Provider>\n    );\n  }\n}\n\nEditorControls.propTypes = {\n  advancedTraceTypeSelector: PropTypes.bool,\n  afterAddTrace: PropTypes.func,\n  afterDeleteAnnotation: PropTypes.func,\n  afterDeleteShape: PropTypes.func,\n  afterDeleteImage: PropTypes.func,\n  afterDeleteTrace: PropTypes.func,\n  afterUpdateLayout: PropTypes.func,\n  afterUpdateTraces: PropTypes.func,\n  beforeAddTrace: PropTypes.func,\n  beforeDeleteAnnotation: PropTypes.func,\n  beforeDeleteShape: PropTypes.func,\n  beforeDeleteImage: PropTypes.func,\n  beforeDeleteTrace: PropTypes.func,\n  beforeUpdateLayout: PropTypes.func,\n  beforeUpdateTraces: PropTypes.func,\n  children: PropTypes.node,\n  className: PropTypes.string,\n  srcConverters: PropTypes.shape({\n    toSrc: PropTypes.func.isRequired,\n    fromSrc: PropTypes.func.isRequired,\n  }),\n  dataSourceOptionRenderer: PropTypes.func,\n  dataSourceOptions: PropTypes.array,\n  dataSources: PropTypes.object,\n  dataSourceValueRenderer: PropTypes.func,\n  dictionaries: PropTypes.object,\n  graphDiv: PropTypes.object,\n  locale: PropTypes.string,\n  onUpdate: PropTypes.func,\n  plotly: PropTypes.object,\n  showFieldTooltips: PropTypes.bool,\n  traceTypesConfig: PropTypes.object,\n  makeDefaultTrace: PropTypes.func,\n  glByDefault: PropTypes.bool,\n  mapBoxAccess: PropTypes.bool,\n  fontOptions: PropTypes.array,\n  chartHelp: PropTypes.object,\n};\n\nEditorControls.defaultProps = {\n  showFieldTooltips: false,\n  locale: 'en',\n  traceTypesConfig: {\n    categories: _ => categoryLayout(_),\n    traces: _ => traceTypes(_),\n    complex: true,\n  },\n  fontOptions: DEFAULT_FONTS,\n};\n\nEditorControls.childContextTypes = {\n  advancedTraceTypeSelector: PropTypes.bool,\n  config: PropTypes.object,\n  srcConverters: PropTypes.shape({\n    toSrc: PropTypes.func.isRequired,\n    fromSrc: PropTypes.func.isRequired,\n  }),\n  data: PropTypes.array,\n  dataSourceOptionRenderer: PropTypes.func,\n  dataSourceOptions: PropTypes.array,\n  dataSources: PropTypes.object,\n  dataSourceValueRenderer: PropTypes.func,\n  dictionaries: PropTypes.object,\n  frames: PropTypes.array,\n  fullData: PropTypes.array,\n  fullLayout: PropTypes.object,\n  graphDiv: PropTypes.any,\n  layout: PropTypes.object,\n  locale: PropTypes.string,\n  localize: PropTypes.func,\n  onUpdate: PropTypes.func,\n  plotly: PropTypes.object,\n  plotSchema: PropTypes.object,\n  traceTypesConfig: PropTypes.object,\n  showFieldTooltips: PropTypes.bool,\n  glByDefault: PropTypes.bool,\n  mapBoxAccess: PropTypes.bool,\n  fontOptions: PropTypes.array,\n  chartHelp: PropTypes.object,\n};\n\nexport default EditorControls;\n"]}