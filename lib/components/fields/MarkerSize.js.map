{"version":3,"sources":["../../../src/components/fields/MarkerSize.js"],"names":["UnconnectedMarkerSize","props","context","type","container","marker","sizesrc","Array","isArray","size","fullContainer","state","value","constant","fullValue","variable","setType","bind","setValue","setState","updatePlot","updateContainer","inputValue","attr","_","localize","options","label","multiValued","includes","MULTI_VALUED","Component","propTypes","PropTypes","any","func","Field","contextTypes"],"mappings":"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","file":"MarkerSize.js","sourcesContent":["import Field from './Field';\nimport PropTypes from 'prop-types';\nimport React, {Component} from 'react';\nimport {connectToContainer} from 'lib';\nimport RadioBlocks from '../widgets/RadioBlocks';\nimport Numeric from './Numeric';\nimport DataSelector from './DataSelector';\nimport {MULTI_VALUED} from 'lib/constants';\n\nclass UnconnectedMarkerSize extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    let type = null;\n    if (!props.container.marker || (props.container.marker && !props.container.marker.sizesrc)) {\n      type = 'constant';\n    } else if (\n      props.container.marker &&\n      Array.isArray(props.container.marker.size) &&\n      props.fullContainer.marker &&\n      Array.isArray(props.fullContainer.marker.size)\n    ) {\n      type = 'variable';\n    }\n\n    this.state = {\n      type,\n      value: {\n        constant: type === 'constant' ? props.fullValue : '6',\n        variable: type === 'variable' ? props.fullValue : null,\n      },\n    };\n\n    this.setType = this.setType.bind(this);\n    this.setValue = this.setValue.bind(this);\n  }\n\n  setType(type) {\n    this.setState({type: type});\n    this.props.updatePlot(this.state.value[type]);\n    if (type === 'constant') {\n      this.context.updateContainer({['marker.sizesrc']: null});\n    } else {\n      this.context.updateContainer({\n        ['marker.size']: null,\n        ['marker.sizesrc']: null,\n      });\n    }\n  }\n\n  setValue(inputValue) {\n    const {type} = this.state;\n\n    this.setState(\n      type === 'constant' ? {value: {constant: inputValue}} : {value: {variable: inputValue}}\n    );\n    this.props.updatePlot(inputValue);\n  }\n\n  render() {\n    const {attr, fullValue} = this.props;\n    const {localize: _} = this.context;\n    const {type, value} = this.state;\n    const options = [\n      {label: _('Constant'), value: 'constant'},\n      {label: _('Variable'), value: 'variable'},\n    ];\n    const multiValued =\n      this.props.multiValued || (Array.isArray(fullValue) && fullValue.includes(MULTI_VALUED));\n\n    return (\n      <Field {...this.props} multiValued={multiValued} attr={attr}>\n        <RadioBlocks options={options} activeOption={type} onOptionChange={this.setType} />\n        {type === 'constant' ? (\n          <Numeric\n            suppressMultiValuedMessage\n            attr=\"marker.size\"\n            updatePlot={this.setValue}\n            fullValue={value.constant}\n          />\n        ) : multiValued ? null : (\n          <DataSelector suppressMultiValuedMessage attr=\"marker.size\" updatePlot={this.setValue} />\n        )}\n      </Field>\n    );\n  }\n}\n\nUnconnectedMarkerSize.propTypes = {\n  fullValue: PropTypes.any,\n  updatePlot: PropTypes.func,\n  ...Field.propTypes,\n};\n\nUnconnectedMarkerSize.contextTypes = {\n  localize: PropTypes.func,\n  updateContainer: PropTypes.func,\n};\n\nexport default connectToContainer(UnconnectedMarkerSize);\n"]}