{"version":3,"sources":["../../../src/components/fields/DropdownCustom.js"],"names":["UnconnectedDropdownCustom","props","context","setValue","bind","setLocals","state","custom","value","customOpt","options","map","o","includes","fullValue","undefined","MULTI_VALUED_PLACEHOLDER","defaultOpt","setState","updateContainer","attr","backgroundDark","clearable","optionRenderer","valueRenderer","placeholder","Component","propTypes","PropTypes","any","updatePlot","func","bool","oneOfType","number","string","label","Field","contextTypes"],"mappings":"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","file":"DropdownCustom.js","sourcesContent":["import React, {Component} from 'react';\nimport PropTypes from 'prop-types';\nimport {connectToContainer} from 'lib';\nimport {MULTI_VALUED_PLACEHOLDER} from 'lib/constants';\nimport Field from './Field';\nimport DropdownWidget from '../widgets/Dropdown';\nimport Text from './Text';\n\nexport class UnconnectedDropdownCustom extends Component {\n  constructor(props, context) {\n    super(props, context);\n\n    this.setValue = this.setValue.bind(this);\n    this.setLocals = this.setLocals.bind(this);\n\n    this.setLocals(props);\n\n    this.state = {\n      custom:\n        this.value === props.customOpt ||\n        !this.props.options.map(o => o.value).includes(this.value),\n    };\n  }\n\n  componentWillReceiveProps(props) {\n    this.setLocals(props);\n  }\n\n  setLocals(props) {\n    this.value =\n      props.fullValue === undefined || props.fullValue === MULTI_VALUED_PLACEHOLDER // eslint-disable-line no-undefined\n        ? this.props.defaultOpt\n        : props.fullValue;\n  }\n\n  setValue(value, custom = false) {\n    this.value = value;\n    const customOpt = this.props.customOpt;\n    this.setState({\n      custom: (custom || value === customOpt) && value !== '',\n    });\n    this.props.updateContainer({\n      [this.props.attr]: value === customOpt && !custom ? customOpt : value,\n    });\n  }\n\n  render() {\n    const {options, attr, customOpt} = this.props;\n    const value =\n      (this.value === '' || !options.map(o => o.value).includes(this.value)) && this.state.custom\n        ? customOpt\n        : this.value;\n\n    return (\n      <Field {...this.props}>\n        <DropdownWidget\n          backgroundDark={this.props.backgroundDark}\n          options={options}\n          value={value}\n          onChange={this.setValue}\n          clearable={this.props.clearable}\n          optionRenderer={this.props.optionRenderer}\n          valueRenderer={this.props.valueRenderer}\n          placeholder={this.props.placeholder}\n        />\n\n        {this.state.custom && (\n          <Text\n            attr={attr}\n            updatePlot={value => this.setValue(value, true)}\n            onChange={value => {\n              if (value) {\n                this.setValue(value, true);\n              }\n            }}\n          />\n        )}\n      </Field>\n    );\n  }\n}\n\nUnconnectedDropdownCustom.propTypes = {\n  fullValue: PropTypes.any,\n  updatePlot: PropTypes.func,\n  clearable: PropTypes.bool,\n  defaultOpt: PropTypes.oneOfType([PropTypes.number, PropTypes.bool, PropTypes.string]),\n  customOpt: PropTypes.oneOfType([PropTypes.number, PropTypes.bool, PropTypes.string]),\n  label: PropTypes.string,\n  attr: PropTypes.string,\n  ...Field.propTypes,\n};\n\nUnconnectedDropdownCustom.contextTypes = {\n  updateContainer: PropTypes.func,\n};\n\nexport default connectToContainer(UnconnectedDropdownCustom);\n"]}