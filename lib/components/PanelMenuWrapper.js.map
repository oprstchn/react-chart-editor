{"version":3,"sources":["../../src/components/PanelMenuWrapper.js"],"names":["PanelsWithSidebar","props","opts","computeMenuOptions","firstSidebarGroup","filter","o","panels","state","group","name","panel","setPanel","bind","renderSection","setState","section","i","type","plotly_editor_traits","sidebar_element","key","children","menuPanelOrder","sections","groupLookup","groupIndex","React","Children","toArray","forEach","child","obj","hasOwnProperty","length","push","menuOpts","provideValue","map","Component","propTypes","PropTypes","node","array","childContextTypes","func"],"mappings":"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","file":"PanelMenuWrapper.js","sourcesContent":["import PropTypes from 'prop-types';\nimport React, {cloneElement, Component} from 'react';\nimport SidebarGroup from './sidebar/SidebarGroup';\nimport {bem} from 'lib';\nimport sortMenu from 'lib/sortMenu';\nimport {PanelMenuWrapperContext} from '../context';\n\nclass PanelsWithSidebar extends Component {\n  constructor(props) {\n    super(props);\n\n    const opts = this.computeMenuOptions(props);\n    const firstSidebarGroup = opts.filter(o => o.panels)[0];\n\n    this.state = {\n      group: firstSidebarGroup.name,\n      panel: firstSidebarGroup.panels[0],\n    };\n\n    this.setPanel = this.setPanel.bind(this);\n    this.renderSection = this.renderSection.bind(this);\n  }\n\n  setPanel(group, panel) {\n    this.setState({group, panel});\n  }\n\n  getChildContext() {\n    return {\n      setPanel: this.setPanel,\n    };\n  }\n\n  provideValue() {\n    return {\n      setPanel: this.setPanel,\n    };\n  }\n\n  renderSection(section, i) {\n    if (section.type && (section.type.plotly_editor_traits || {}).sidebar_element) {\n      return cloneElement(section, {key: i});\n    }\n    return (\n      <SidebarGroup\n        key={i}\n        selectedGroup={this.state.group}\n        selectedPanel={this.state.panel}\n        group={section.name}\n        panels={section.panels}\n        onChangeGroup={this.setPanel}\n      />\n    );\n  }\n\n  computeMenuOptions(props) {\n    const {children, menuPanelOrder} = props;\n    const sections = [];\n    const groupLookup = {};\n    let groupIndex;\n    const panels = React.Children.toArray(children);\n\n    if (menuPanelOrder) {\n      sortMenu(panels, menuPanelOrder);\n    }\n\n    panels.forEach(child => {\n      if (!child) {\n        return;\n      }\n      const group = child.props.group;\n      const name = child.props.name;\n\n      if (group && name) {\n        let obj;\n        if (groupLookup.hasOwnProperty(group)) {\n          groupIndex = groupLookup[group];\n          obj = sections[groupIndex];\n        } else {\n          groupLookup[group] = sections.length;\n          obj = {name: group, panels: []};\n          sections.push(obj);\n        }\n        obj.panels.push(name);\n      }\n\n      if ((child.type.plotly_editor_traits || {}).sidebar_element) {\n        sections.push(child);\n      }\n    });\n\n    return sections;\n  }\n\n  render() {\n    const menuOpts = this.computeMenuOptions(this.props);\n\n    return (\n      <PanelMenuWrapperContext.Provider value={this.provideValue()}>\n        <div className={bem('editor_controls', 'wrapper')}>\n          <div className={bem('sidebar')}>{menuOpts.map(this.renderSection)}</div>\n          {React.Children.map(\n            this.props.children,\n            (child, i) =>\n              child === null ||\n              this.state.group !== child.props.group ||\n              this.state.panel !== child.props.name\n                ? null\n                : cloneElement(child, {key: i})\n          )}\n        </div>\n      </PanelMenuWrapperContext.Provider>\n    );\n  }\n}\n\nPanelsWithSidebar.propTypes = {\n  children: PropTypes.node,\n  menuPanelOrder: PropTypes.array,\n};\n\nPanelsWithSidebar.childContextTypes = {\n  setPanel: PropTypes.func,\n};\n\nexport default PanelsWithSidebar;\n"]}