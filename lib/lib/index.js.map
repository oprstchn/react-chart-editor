{"version":3,"sources":["../../src/lib/index.js"],"names":["PlotlyIcons","TOO_LIGHT_FACTOR","clamp","value","min","max","Math","getDisplayName","WrappedComponent","displayName","name","tooLight","color","hslColor","toHsl","l","renderTraceIcon","trace","prefix","gl","componentName","endsWith","slice","length","PlotLineIcon","transpose","originalArray","every","Array","isArray","a","map","longestArrayItem","forEach","newArray","outerIndex","innerIndex","push","specialTableCase","traceType","srcAttributePath","some","maybeTransposeData","data","isTransposable2DArray","includes","maybeAdjustSrc","src","config","fromSrc","adjustColorscale","colorscale","numberOfNeededColors","colorscaleType","repeat","repetitions","ceil","fill","reduce","b","concat","getFullTrace","props","context","fullTrace","fullData","fullDataArrayPosition","filter","t","traceIndexes","index","transforms","type","_fullInput","axisIdToAxisName","bem","capitalize","lowerCase","upperCase","removeNonWord","camelCase","pascalCase","connectCartesianSubplotToLayout","connectNonCartesianSubplotToLayout","connectAnnotationToLayout","connectShapeToLayout","connectSliderToLayout","connectUpdateMenuToLayout","connectImageToLayout","connectAxesToLayout","connectLayoutToPlot","connectToContainer","connectRangeSelectorToAxis","connectTransformToTrace","connectAggregationToTransform","connectTraceToPlot","containerConnectedContextTypes","computeTraceOptionsFromSchema","traceTypeToPlotlyInitFigure","dereference","getAllAxes","getAxisTitle","getSubplotTitle","isPlainObject","localize","localizeString","plotlyTraceToCustomTrace","unpackPlotProps","walkObject","striptags","traceTypeToAxisType"],"mappings":"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","file":"index.js","sourcesContent":["import bem from './bem';\nimport connectCartesianSubplotToLayout from './connectCartesianSubplotToLayout';\nimport connectNonCartesianSubplotToLayout from './connectNonCartesianSubplotToLayout';\nimport connectAnnotationToLayout from './connectAnnotationToLayout';\nimport connectShapeToLayout from './connectShapeToLayout';\nimport connectSliderToLayout from './connectSliderToLayout';\nimport connectImageToLayout from './connectImageToLayout';\nimport connectUpdateMenuToLayout from './connectUpdateMenuToLayout';\nimport connectRangeSelectorToAxis from './connectRangeSelectorToAxis';\nimport connectTransformToTrace from './connectTransformToTrace';\nimport connectAggregationToTransform from './connectAggregationToTransform';\nimport connectAxesToLayout from './connectAxesToLayout';\nimport connectLayoutToPlot from './connectLayoutToPlot';\nimport connectToContainer, {containerConnectedContextTypes} from './connectToContainer';\nimport {computeTraceOptionsFromSchema} from './computeTraceOptionsFromSchema';\nimport connectTraceToPlot from './connectTraceToPlot';\nimport dereference from './dereference';\nimport getAllAxes, {\n  axisIdToAxisName,\n  traceTypeToAxisType,\n  getAxisTitle,\n  getSubplotTitle,\n} from './getAllAxes';\nimport localize, {localizeString} from './localize';\nimport tinyColor from 'tinycolor2';\nimport unpackPlotProps from './unpackPlotProps';\nimport walkObject, {isPlainObject} from './walkObject';\nimport {traceTypeToPlotlyInitFigure, plotlyTraceToCustomTrace} from './customTraceType';\nimport * as PlotlyIcons from 'plotly-icons';\nimport striptags from './striptags';\nimport {capitalize, lowerCase, upperCase, removeNonWord, camelCase, pascalCase} from './strings';\nimport {getColorscale} from 'react-colorscales';\n\nconst TOO_LIGHT_FACTOR = 0.8;\n\nfunction clamp(value, min, max) {\n  return Math.max(min, Math.min(max, value));\n}\n\nfunction getDisplayName(WrappedComponent) {\n  return WrappedComponent.displayName || WrappedComponent.name || 'Component';\n}\n\nfunction tooLight(color) {\n  const hslColor = tinyColor(color).toHsl();\n  return hslColor.l > TOO_LIGHT_FACTOR;\n}\n\nfunction renderTraceIcon(trace, prefix = 'Plot') {\n  if (!trace) {\n    return null;\n  }\n  const gl = 'gl';\n  const componentName = `${prefix}${pascalCase(\n    trace.endsWith(gl) ? trace.slice(0, -gl.length) : trace\n  )}Icon`;\n\n  return PlotlyIcons[componentName] ? PlotlyIcons[componentName] : PlotlyIcons.PlotLineIcon;\n}\n\nfunction transpose(originalArray) {\n  // if we want to transpose a uni dimensional array\n  if (originalArray.every(a => !Array.isArray(a))) {\n    return originalArray.map(a => [a]);\n  }\n\n  let longestArrayItem = Array.isArray(originalArray[0]) ? originalArray[0].length : 1;\n\n  originalArray.forEach(a => {\n    // if it's not an array, it's a string\n    const length = Array.isArray(a) ? a.length : 1;\n    if (length > longestArrayItem) {\n      longestArrayItem = length;\n    }\n  });\n\n  const newArray = new Array(longestArrayItem);\n\n  for (let outerIndex = 0; outerIndex < originalArray.length; outerIndex++) {\n    if (!Array.isArray(originalArray[outerIndex])) {\n      originalArray[outerIndex] = [originalArray[outerIndex]];\n    }\n\n    for (let innerIndex = 0; innerIndex < longestArrayItem; innerIndex++) {\n      // ensure we have an array to push to\n      if (!Array.isArray(newArray[innerIndex])) {\n        newArray[innerIndex] = [];\n      }\n\n      const value =\n        typeof originalArray[outerIndex][innerIndex] !== 'undefined'\n          ? originalArray[outerIndex][innerIndex]\n          : null;\n      newArray[innerIndex].push(value);\n    }\n  }\n\n  return newArray;\n}\n\nconst specialTableCase = (traceType, srcAttributePath) => {\n  /* Just more user friendly\n   * Table traces have many configuration options,\n   * The below attributes can be 2d or 1d and will affect the plot differently\n   * EX:\n   * header.values = ['Jan', 'Feb', 'Mar'] => will put data in a row\n   * header.values = [['Jan', 1], ['Feb', 2], ['Mar', 3]] => will create 3 columns\n   * 1d arrays affect columns\n   * 2d arrays affect rows within each column\n   */\n  return (\n    traceType === 'table' &&\n    [\n      'header.valuessrc',\n      'header.font.colorsrc',\n      'header.font.sizesrc',\n      'header.fill.colorsrc',\n      'columnwidthsrc',\n    ].some(a => srcAttributePath.endsWith(a))\n  );\n};\n\nfunction maybeTransposeData(data, srcAttributePath, traceType) {\n  if (!data || (Array.isArray(data) && data.length === 0)) {\n    return null;\n  }\n\n  const isTransposable2DArray =\n    srcAttributePath.endsWith('zsrc') &&\n    ['contour', 'contourgl', 'heatmap', 'heatmapgl', 'surface', 'carpet', 'contourcarpet'].includes(\n      traceType\n    );\n\n  if (isTransposable2DArray) {\n    return transpose(data);\n  }\n\n  if (\n    specialTableCase(traceType, srcAttributePath) &&\n    Array.isArray(data[0]) &&\n    data.length === 1\n  ) {\n    return data[0];\n  }\n\n  return data;\n}\n\nfunction maybeAdjustSrc(src, srcAttributePath, traceType, config) {\n  if (!src || (Array.isArray(src) && src.length === 0)) {\n    return null;\n  }\n\n  if (specialTableCase(traceType, srcAttributePath) && src.length === 1) {\n    return src[0];\n  }\n\n  return config && config.fromSrc ? config.fromSrc(src, traceType) : src;\n}\n\nfunction adjustColorscale(colorscale, numberOfNeededColors, colorscaleType, config) {\n  if (config && config.repeat) {\n    if (numberOfNeededColors < colorscale.length) {\n      return colorscale.slice(0, numberOfNeededColors);\n    }\n\n    const repetitions = Math.ceil(numberOfNeededColors / colorscale.length);\n    const newArray = new Array(repetitions).fill(colorscale);\n    return newArray\n      .reduce((a, b) => {\n        return a.concat(b);\n      }, [])\n      .slice(0, numberOfNeededColors);\n  }\n\n  return getColorscale(colorscale, numberOfNeededColors, null, null, colorscaleType);\n}\n\nfunction getFullTrace(props, context) {\n  let fullTrace = {};\n  if (context.fullData && context.data) {\n    if (props.fullDataArrayPosition) {\n      // fullDataArrayPosition will be supplied in panels that have the canGroup prop\n      fullTrace = context.fullData[props.fullDataArrayPosition[0]];\n    } else {\n      // for all other panels, we'll find fullTrace with the data index\n      fullTrace = context.fullData.filter(t => t && props.traceIndexes[0] === t.index)[0];\n    }\n\n    // For transformed traces, we actually want to read in _fullInput because\n    // there's original parent information that's more useful to the user there\n    // This is true except for fit transforms, where reading in fullData is\n    // what we want\n    if (\n      fullTrace.transforms &&\n      !fullTrace.transforms.some(t => ['moving-average', 'fits'].includes(t.type)) &&\n      !props.fullDataArrayPosition\n    ) {\n      fullTrace = fullTrace._fullInput;\n    }\n  }\n  return fullTrace;\n}\n\nexport {\n  adjustColorscale,\n  axisIdToAxisName,\n  bem,\n  capitalize,\n  lowerCase,\n  upperCase,\n  removeNonWord,\n  camelCase,\n  pascalCase,\n  clamp,\n  connectCartesianSubplotToLayout,\n  connectNonCartesianSubplotToLayout,\n  connectAnnotationToLayout,\n  connectShapeToLayout,\n  connectSliderToLayout,\n  connectUpdateMenuToLayout,\n  connectImageToLayout,\n  connectAxesToLayout,\n  connectLayoutToPlot,\n  connectToContainer,\n  connectRangeSelectorToAxis,\n  connectTransformToTrace,\n  connectAggregationToTransform,\n  connectTraceToPlot,\n  containerConnectedContextTypes,\n  computeTraceOptionsFromSchema,\n  traceTypeToPlotlyInitFigure,\n  dereference,\n  getAllAxes,\n  getAxisTitle,\n  getSubplotTitle,\n  getDisplayName,\n  isPlainObject,\n  localize,\n  localizeString,\n  maybeAdjustSrc,\n  maybeTransposeData,\n  plotlyTraceToCustomTrace,\n  renderTraceIcon,\n  unpackPlotProps,\n  walkObject,\n  tooLight,\n  striptags,\n  traceTypeToAxisType,\n  transpose,\n  getFullTrace,\n};\n"]}